<%- include('includes/header.ejs')  %>
<body>
    <h1>je suis profil</h1>  
    <%- include('includes/navbar.ejs')  %>
    <% if(locals.message){ %>
        <p style="color: green;"> <%= locals.message %> </p>
        <% } %>  
        <% if(locals.myProfil.error){ %>
            <p style="color: red;"> <%= locals.myProfil.error %> please LOG <a href="/login">HERE</a> </p>
        <% } %> 
    <div class="container">      
        <% if(locals.myProfil.success){ %>
            <% let user = locals.myProfil.success  %> 
           
            <div class="card col-md-10">
                <form action="/profil" method="post" enctype="multipart/form-data">
                    <div class="row">                    
                        <div class="col-md-4">                            
                            <a class="change" data-toggle="collapse" href="#collapseExample4"  aria-expanded="false" aria-controls="collapseExample">
                               <img class="card-img-top m-1" src="/img/web.jpg " alt="Card image cap"><i class="fa-solid fa-marker"></i> </a>
                                <div class="collapse" id="collapseExample4">
                                    <div class="modifier">
                                        <input type="file" name="avatar"> 
                                        <button type="submit" class="btn btn-primary btn-sm" id="change">Save</button>
                                    </div>
                                </div>
                        </div>
                        <div class="col-md-4">
                            <div class="card-body  ">
                                <a class="change" data-toggle="collapse" href="#collapseExample1"  aria-expanded="false" aria-controls="collapseExample">
                                <p class="card-text mb-2"><i class="fa-solid fa-marker"></i><strong>Lastname :</strong> <%= user.lastname %></p></a>
                                <div class="collapse" id="collapseExample1">
                                    <div class="modifier">
                                        <input type="text" name="lastname" placeholder="new lastname"> 
                                        <button type="submit" class="btn btn-primary btn-sm" id="change">Save</button>
                                    </div>
                                </div>
                                <a data-toggle="collapse" href="#collapseExample2"  aria-expanded="false" aria-controls="collapseExample">
                                <p class="card-text mb-2"><i class="fa-solid fa-marker"></i><strong>Firstname :</strong><%= user.firstname %> </p></a>
                                <div class="collapse" id="collapseExample2">
                                    <div class="modifier">
                                        <input type="text" name="firstname" placeholder="new firstname">
                                        <button type="submit" class="btn btn-primary btn-sm" id="change">save</button>
                                   </div>
                                </div>
                                <a data-toggle="collapse" href="#collapseExample3"  aria-expanded="false" aria-controls="collapseExample">
                                <p class="card-text m-3"><strong>Bio :</strong><%= user.bio %>  </p></a>
                                <div class="collapse" id="collapseExample3">
                                    <div class="modifier">
                                        <input type="text" name="bio" placeholder="new bio"> 
                                        <button type="submit" class="btn btn-primary btn-sm" id="change">Save</button> 
                                    </div>    
                                </div>
                                <p class="card-text "><strong> Email :</strong><%= user.email %> </p>
                            </div>
                        </div>                          
                    </div>
                </form>
                <hr>
                <form action="/profil/delete" method="post">
                    <button class="btnsup" type="submit"><i class="fa-regular fa-trash-can color:red"></i></button>
                </form> 
            </div>  
            









            
            <ul>
                <form action="/profil" method="post" enctype="multipart/form-data">
                    <% if(user.avatar != null){ %>
                        <li><img src="../data/uploads/<%= user.avatar  %> " alt="photo de profil" style="width: 50px;height: 50px;border-radius: 100%;"></li>
                        <input type="file" name="avatar"><br><br>
                        <% } %> 
                <li><strong>Email : </strong> <%= user.email %> </li>
                <br>
                <li><strong>Firstname : </strong> <%= user.firstname %> </li>
                <input type="text" name="firstname" placeholder="new firstname">
                <br><br>
                <li><strong>Lastname : </strong> <%= user.lastname %> </li>
                <input type="text" name="lastname" placeholder="new lastname">
                <br><br>
                <li><strong>Bio : </strong> <%= user.bio %> </li>
                <input type="text" name="bio" placeholder="new bio">
                <br><br>
                <button type="submit">Update PRofil</button>
            </form>
            <br>
            <form action="/profil/delete" method="post">
                <button style="color: red;" type="submit">Supp profil</button>
            </form>
            </ul>
            <% } %> 
        </div>   
        <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>        
</body>

</html>